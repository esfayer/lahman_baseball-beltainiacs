/* SELECT 	p.namefirst,
		p.namelast,
		SUM(sa.salary)
FROM people AS p
LEFT JOIN collegeplaying AS c
ON p.playerid = c.playerid
LEFT JOIN schools AS s
ON c.schoolid = s.schoolid
LEFT JOIN salaries AS sa
ON p.playerid = sa.playerid
WHERE s.schoolname LIKE '%Vanderbilt%' AND sa.salary IS NOT NULL
GROUP BY p.namefirst, p.namelast
ORDER BY SUM(sa.salary) DESC; */

/* SELECT 	SUM(po),
		CASE
			WHEN pos = 'OF' THEN 'Outfield'
			WHEN pos = 'P' THEN 'Battery'
			WHEN pos = 'C' THEN 'Battery'
			WHEN pos = '1B' THEN 'Infield'
			WHEN pos = '2B' THEN 'Infield'
			WHEN pos = '3B' THEN 'Infield'
			WHEN pos = 'SS' THEN 'Infield'
			END AS pos_group
FROM fielding
WHERE yearid = '2016'
GROUP BY pos_group */

-- WITH stolen_bases AS ()

/* SELECT 	p.namefirst,
		p.namelast,
		SUM((b.sb)-(b.cs)) AS sb_success
FROM batting AS b
LEFT JOIN people AS p
ON b.playerid = p.playerid
WHERE b.sb >= 20
AND b.yearid = 2016
GROUP BY p.namefirst, p.namelast
ORDER BY sb_success DESC; */

SELECT	*
FROM (
		SELECT 	team,
				park,
				SUM((attendance) / (games)) AS avg_attendence
		FROM homegames
		WHERE games >= 10 AND year = 2016
		GROUP BY team, park
		ORDER BY avg_attendence DESC
		LIMIT 5) AS top_5_avg_att
UNION
SELECT 	*
FROM (
				SELECT 	team,
				park,
				SUM((attendance) / (games)) AS avg_attendence
		FROM homegames
		WHERE games >= 10 AND year = 2016par
		GROUP BY team, park
		ORDER BY avg_attendence ASC
		LIMIT 5) AS bottom_5_avg_att
 